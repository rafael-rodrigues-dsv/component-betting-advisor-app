# ğŸ”Œ IntegraÃ§Ã£o com API-Football

> DocumentaÃ§Ã£o completa do fluxo de integraÃ§Ã£o com a API-Football, incluindo diagramas de fluxo, sequÃªncia e contagem de requisiÃ§Ãµes.

---

## ğŸ“Š VisÃ£o Geral

O **Betting Advisor** utiliza a API-Football como fonte de dados para:
- âœ… Buscar jogos disponÃ­veis
- âœ… Obter odds de mÃºltiplas casas de apostas
- âœ… Consultar informaÃ§Ãµes de times e ligas
- âœ… Cachear dados localmente para otimizar requests

**Base URL:** `https://v3.football.api-sports.io`  
**AutenticaÃ§Ã£o:** `x-rapidapi-key` header  
**Limite:** 100 requests/dia (plano gratuito)

---

## ğŸ”„ Diagrama de Fluxo Principal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FLUXO PRINCIPAL - BETTING ADVISOR                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”‚
â”‚  â”‚   USUÃRIO    â”‚                                                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                          â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â”‚ 1. Acessa pÃ¡gina de jogos                                        â”‚
â”‚         â–¼                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚  â”‚  FRONTEND (React)                    â”‚                                  â”‚
â”‚  â”‚  â€¢ Seleciona Liga                    â”‚                                  â”‚
â”‚  â”‚  â€¢ Seleciona Data                    â”‚                                  â”‚
â”‚  â”‚  â€¢ Seleciona EstratÃ©gia              â”‚                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â”‚ 2. GET /api/v1/matches?league=71&date=2026-02-17                 â”‚
â”‚         â–¼                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚  â”‚  BACKEND (FastAPI)                   â”‚                                  â”‚
â”‚  â”‚  â€¢ MatchController                   â”‚                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â”‚ 3. get_matches()                                                 â”‚
â”‚         â–¼                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚  â”‚  MatchApplicationService             â”‚                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â”‚ 4. get_fixtures()                                                â”‚
â”‚         â–¼                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚  â”‚  ProviderFactory                     â”‚                                  â”‚
â”‚  â”‚  â””â”€> APIFootballProvider             â”‚                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â”‚ 5. Verifica Cache Local                                          â”‚
â”‚         â–¼                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚  â”‚  CacheManager (SQLite)               â”‚                                  â”‚
â”‚  â”‚  â€¢ Busca: fixtures:71:2026-02-17    â”‚                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â”œâ”€ Cache HIT? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚         â”‚                              â”‚                                    â”‚
â”‚         â”‚ SIM                          â”‚ NÃƒO                                â”‚
â”‚         â–¼                              â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ Retorna Cacheâ”‚         â”‚  ğŸ“¡ API-FOOTBALL           â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  REQUEST #1                â”‚                   â”‚
â”‚         â”‚                 â”‚  GET /fixtures             â”‚                   â”‚
â”‚         â”‚                 â”‚  ?league=71&date=...       â”‚                   â”‚
â”‚         â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”‚                          â”‚                                        â”‚
â”‚         â”‚                          â”‚ 6. Response (JSON)                    â”‚
â”‚         â”‚                          â–¼                                        â”‚
â”‚         â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚                 â”‚  FixtureParser             â”‚                   â”‚
â”‚         â”‚                 â”‚  â€¢ Parse JSON              â”‚                   â”‚
â”‚         â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”‚                          â”‚                                        â”‚
â”‚         â”‚                          â–¼                                        â”‚
â”‚         â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚                 â”‚  FixtureToMatchMapper      â”‚                   â”‚
â”‚         â”‚                 â”‚  â€¢ JSON â†’ Match (domain)   â”‚                   â”‚
â”‚         â”‚                 â”‚  â€¢ Verifica logo local     â”‚                   â”‚
â”‚         â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”‚                          â”‚                                        â”‚
â”‚         â”‚                          â”‚ 7. Salva no Cache (TTL: 6h)           â”‚
â”‚         â”‚                          â–¼                                        â”‚
â”‚         â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚                 â”‚  CacheManager              â”‚                   â”‚
â”‚         â”‚                 â”‚  â€¢ Persiste SQLite         â”‚                   â”‚
â”‚         â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”‚                          â”‚                                        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                          â”‚                                                  â”‚
â”‚                          â”‚ 8. Para cada Match                              â”‚
â”‚                          â–¼                                                  â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                 â”‚  get_odds(fixture_id)      â”‚                             â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                          â”‚                                                  â”‚
â”‚                          â”‚ 9. Verifica Cache                               â”‚
â”‚                          â–¼                                                  â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                 â”‚  CacheManager              â”‚                             â”‚
â”‚                 â”‚  â€¢ odds:{fixture_id}       â”‚                             â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                          â”‚                                                  â”‚
â”‚                 â”œâ”€ Cache HIT? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚                 â”‚                       â”‚                                   â”‚
â”‚                 â”‚ SIM                   â”‚ NÃƒO                               â”‚
â”‚                 â–¼                       â–¼                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚Retorna Cacheâ”‚      â”‚  ğŸ“¡ API-FOOTBALL         â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  REQUEST #2, #3, #4...   â”‚                   â”‚
â”‚              â”‚              â”‚  GET /odds?fixture=...   â”‚                   â”‚
â”‚              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚              â”‚                         â”‚                                    â”‚
â”‚              â”‚                         â”‚ 10. Response (JSON)                â”‚
â”‚              â”‚                         â–¼                                    â”‚
â”‚              â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚              â”‚              â”‚  OddsParser              â”‚                   â”‚
â”‚              â”‚              â”‚  â€¢ Parse JSON            â”‚                   â”‚
â”‚              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚              â”‚                         â”‚                                    â”‚
â”‚              â”‚                         â–¼                                    â”‚
â”‚              â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚              â”‚              â”‚  OddsMapper              â”‚                   â”‚
â”‚              â”‚              â”‚  â€¢ JSON â†’ Odds (domain)  â”‚                   â”‚
â”‚              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚              â”‚                         â”‚                                    â”‚
â”‚              â”‚                         â”‚ 11. Salva Cache (TTL: 30min)      â”‚
â”‚              â”‚                         â–¼                                    â”‚
â”‚              â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚              â”‚              â”‚  CacheManager            â”‚                   â”‚
â”‚              â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚              â”‚                         â”‚                                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                          â”‚                                                  â”‚
â”‚                          â”‚ 12. Match + Odds completos                      â”‚
â”‚                          â–¼                                                  â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                 â”‚  Retorna lista de Matches  â”‚                             â”‚
â”‚                 â”‚  com Odds de cada casa     â”‚                             â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                          â”‚                                                  â”‚
â”‚                          â”‚ 13. Response JSON                               â”‚
â”‚                          â–¼                                                  â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                 â”‚  FRONTEND                  â”‚                             â”‚
â”‚                 â”‚  â€¢ Exibe jogos             â”‚                             â”‚
â”‚                 â”‚  â€¢ UsuÃ¡rio seleciona       â”‚                             â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Diagrama de SequÃªncia - Buscar Jogos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend â”‚  â”‚Controllerâ”‚  â”‚AppService   â”‚  â”‚ Provider â”‚  â”‚CacheManager  â”‚  â”‚ API-Football â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚ GET /matchesâ”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚ get_matches()  â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚ get_fixtures()â”‚               â”‚                 â”‚
     â”‚             â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ get(cache_key) â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ Cache MISS     â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ GET /fixtures?league=71&date=... â”‚
     â”‚             â”‚                â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚              Response (10 jogos)â”‚
     â”‚             â”‚                â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ Parse + Map    â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚        â”‚       â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ set(cache, 6h) â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ âœ… Saved       â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
     â”‚             â”‚                â”‚              â”‚ â”‚ PARA CADA JOGO (10x):       â”‚ â”‚
     â”‚             â”‚                â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ get_odds(f_id) â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ Cache MISS     â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ GET /odds?fixture={id}           â”‚
     â”‚             â”‚                â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                    Response (Odds)â”‚
     â”‚             â”‚                â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ Parse + Map    â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚        â”‚       â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ set(cache,30min)                 â”‚
     â”‚             â”‚                â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚ âœ… Saved       â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚ [Matches+Odds]                â”‚                 â”‚
     â”‚             â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚    [Matches]   â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚  JSON Response                â”‚              â”‚                â”‚                 â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
     â”‚             â”‚                â”‚              â”‚                â”‚                 â”‚
```

---

## ğŸ”¢ Contagem de RequisiÃ§Ãµes por Fluxo

### **Fluxo 1: Carregar PÃ¡gina de Jogos** (Primeira Vez - Cache Vazio)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CENÃRIO: UsuÃ¡rio acessa pÃ¡gina pela primeira vez               â”‚
â”‚  CACHE: Vazio                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. GET /fixtures?league=71&date=2026-02-17                     â”‚
â”‚     â””â”€> Retorna: 10 jogos                          [1 request] â”‚
â”‚                                                                 â”‚
â”‚  2. GET /odds?fixture={id1}                         [1 request] â”‚
â”‚  3. GET /odds?fixture={id2}                         [1 request] â”‚
â”‚  4. GET /odds?fixture={id3}                         [1 request] â”‚
â”‚  5. GET /odds?fixture={id4}                         [1 request] â”‚
â”‚  6. GET /odds?fixture={id5}                         [1 request] â”‚
â”‚  7. GET /odds?fixture={id6}                         [1 request] â”‚
â”‚  8. GET /odds?fixture={id7}                         [1 request] â”‚
â”‚  9. GET /odds?fixture={id8}                         [1 request] â”‚
â”‚  10. GET /odds?fixture={id9}                        [1 request] â”‚
â”‚  11. GET /odds?fixture={id10}                       [1 request] â”‚
â”‚                                                                 â”‚
â”‚  TOTAL: 11 requests para API-Football                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**FÃ³rmula:** `1 (fixtures) + N (odds)` onde N = nÃºmero de jogos

---

### **Fluxo 2: Carregar PÃ¡gina de Jogos** (Cache Ativo)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CENÃRIO: UsuÃ¡rio acessa dentro de 30min (cache ativo)         â”‚
â”‚  CACHE: Fixtures (6h) + Odds (30min)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. Busca fixtures no cache                         [0 request] â”‚
â”‚     â””â”€> Cache HIT! âœ… Retorna do SQLite                        â”‚
â”‚                                                                 â”‚
â”‚  2. Busca odds no cache (10x)                       [0 request] â”‚
â”‚     â””â”€> Cache HIT! âœ… Retorna do SQLite                        â”‚
â”‚                                                                 â”‚
â”‚  TOTAL: 0 requests para API-Football                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Economia:** 100% das requisiÃ§Ãµes

---

### **Fluxo 3: Analisar Jogos Selecionados**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CENÃRIO: UsuÃ¡rio seleciona 3 jogos e clica "Analisar"         â”‚
â”‚  CACHE: Odds jÃ¡ estÃ£o em cache (buscados no Fluxo 1)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. POST /api/v1/analyze                                        â”‚
â”‚     â€¢ Body: { match_ids: [id1, id2, id3], strategy: "..." }   â”‚
â”‚                                                                 â”‚
â”‚  2. Application Service busca dados no cache    [0 request]    â”‚
â”‚     â””â”€> Todos os dados jÃ¡ estÃ£o em memÃ³ria                     â”‚
â”‚                                                                 â”‚
â”‚  3. OddsAnalyzer processa estratÃ©gia                            â”‚
â”‚     â””â”€> CÃ¡lculo local (sem API)                                â”‚
â”‚                                                                 â”‚
â”‚  TOTAL: 0 requests para API-Football                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Fluxo 4: Criar Bilhete**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CENÃRIO: UsuÃ¡rio cria bilhete com 3 apostas                   â”‚
â”‚  CACHE: NÃ£o necessÃ¡rio (dados jÃ¡ estÃ£o no frontend)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. POST /api/v1/tickets                                        â”‚
â”‚     â€¢ Body: { bets: [...], stake: 100 }                        â”‚
â”‚                                                                 â”‚
â”‚  2. TicketApplicationService cria bilhete                       â”‚
â”‚     â””â”€> Persiste no SQLite local                               â”‚
â”‚                                                                 â”‚
â”‚  TOTAL: 0 requests para API-Football                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Fluxo 5: Trocar de Liga/Data**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CENÃRIO: UsuÃ¡rio troca de BrasileirÃ£o para Premier League     â”‚
â”‚  CACHE: Vazio para Premier League                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. GET /fixtures?league=39&date=2026-02-17     [1 request]    â”‚
â”‚     â””â”€> Retorna: 8 jogos da Premier League                     â”‚
â”‚                                                                 â”‚
â”‚  2-9. GET /odds?fixture={id} (8x)               [8 requests]   â”‚
â”‚                                                                 â”‚
â”‚  TOTAL: 9 requests para API-Football                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Resumo de RequisiÃ§Ãµes por Dia

### **CenÃ¡rio TÃ­pico de Uso (1 usuÃ¡rio)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ATIVIDADE DIÃRIA                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  09:00 - Acessa BrasileirÃ£o (Cache vazio)                             â”‚
â”‚          â””â”€> 1 + 10 = 11 requests                                     â”‚
â”‚                                                                        â”‚
â”‚  09:05 - Analisa 3 jogos                                              â”‚
â”‚          â””â”€> 0 requests (cache)                                       â”‚
â”‚                                                                        â”‚
â”‚  09:10 - Cria bilhete                                                 â”‚
â”‚          â””â”€> 0 requests (local)                                       â”‚
â”‚                                                                        â”‚
â”‚  12:00 - Acessa Copa do Brasil (Cache vazio)                          â”‚
â”‚          â””â”€> 1 + 6 = 7 requests                                       â”‚
â”‚                                                                        â”‚
â”‚  15:00 - Acessa BrasileirÃ£o novamente                                 â”‚
â”‚          â””â”€> 0 requests (cache ativo - 6h)                            â”‚
â”‚                                                                        â”‚
â”‚  18:00 - Acessa Premier League (Cache vazio)                          â”‚
â”‚          â””â”€> 1 + 8 = 9 requests                                       â”‚
â”‚                                                                        â”‚
â”‚  20:00 - Refresh BrasileirÃ£o                                          â”‚
â”‚          â””â”€> 10 requests (cache de odds expirou - 30min)             â”‚
â”‚                                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  TOTAL DO DIA: 37 requests                                            â”‚
â”‚  LIMITE DIÃRIO: 100 requests                                          â”‚
â”‚  MARGEM: 63 requests disponÃ­veis (63%)                                â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ OtimizaÃ§Ãµes Implementadas

### **1. Cache em MÃºltiplas Camadas**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ESTRATÃ‰GIA DE CACHE                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Layer 1: SQLite (Persistente)                             â”‚
â”‚  â”œâ”€ Fixtures: TTL 6 horas                                  â”‚
â”‚  â”œâ”€ Odds: TTL 30 minutos                                   â”‚
â”‚  â””â”€ Leagues: TTL 7 dias                                    â”‚
â”‚                                                             â”‚
â”‚  Layer 2: MemÃ³ria (Runtime)                                â”‚
â”‚  â””â”€ Provider guarda instÃ¢ncia durante execuÃ§Ã£o             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Resultado:** ReduÃ§Ã£o de 70-90% de requests para API

---

### **2. Batch Loading**

Buscar todos os jogos de uma liga/data de uma vez:

```python
# âœ… BOM - 1 request
GET /fixtures?league=71&date=2026-02-17

# âŒ RUIM - N requests
GET /fixtures?id=1
GET /fixtures?id=2
GET /fixtures?id=3
...
```

---

### **3. Fallback de Logos**

Logos dos times sÃ£o baixados **uma Ãºnica vez** e cacheados localmente:

```
1. Mapper verifica: web_api/src/static/escudos/flamengo.png
2. Se existe: usa local (0 requests)
3. Se nÃ£o existe: usa URL da API (jÃ¡ veio no /fixtures)
```

**Economia:** NÃ£o precisa fazer requests separados para logos

---

### **4. Filtro por Bookmaker**

Quando sabemos que o usuÃ¡rio sÃ³ quer Bet365:

```python
# âœ… OTIMIZADO - dados menores
GET /odds?fixture=123&bookmaker=6

# âŒ NÃƒO OTIMIZADO - todos os bookmakers
GET /odds?fixture=123
```

---

## ğŸ“‰ EstratÃ©gias para Economizar Requests

### **1. PrÃ©-carregar Ligas Principais** âœ… IMPLEMENTADO

**Executado automaticamente ao iniciar o backend (1x por dia):**

```python
# Script executado no startup do FastAPI
# web_api/src/main.py

@app.on_event("startup")
async def preload_main_leagues():
    """
    PrÃ©-carrega fixtures das ligas principais.
    Executa apenas se nÃ£o tiver carga do dia.
    """
    from application.services.preload_service import PreloadService
    
    preload = PreloadService()
    
    # Verifica se jÃ¡ tem carga de hoje
    if await preload.has_todays_cache():
        logger.info("âœ… Cache do dia jÃ¡ existe")
        return
    
    # PrÃ©-carrega 3 ligas principais
    leagues = [71, 73, 39]  # BrasileirÃ£o, Copa BR, Premier
    
    for league_id in leagues:
        await preload.preload_league(league_id, date.today())
    
    logger.info("âœ… PrÃ©-carregamento concluÃ­do!")
```

**Como Funciona:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸš€ PRÃ‰-CARREGAMENTO AUTOMÃTICO                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. Backend inicia (uvicorn main:app)                                       â”‚
â”‚     â””â”€> FastAPI chama evento "startup"                                     â”‚
â”‚                                                                             â”‚
â”‚  2. PreloadService verifica cache                                           â”‚
â”‚     â””â”€> SELECT last_preload_date FROM cache_meta                           â”‚
â”‚                                                                             â”‚
â”‚  3. Se last_preload_date != hoje:                                           â”‚
â”‚     â”œâ”€> GET /fixtures?league=71&date=2026-02-17  [1 request]              â”‚
â”‚     â”œâ”€> GET /fixtures?league=73&date=2026-02-17  [1 request]              â”‚
â”‚     â”œâ”€> GET /fixtures?league=39&date=2026-02-17  [1 request]              â”‚
â”‚     â””â”€> Salva no cache (TTL: atÃ© meia-noite)                               â”‚
â”‚                                                                             â”‚
â”‚  4. Se last_preload_date == hoje:                                           â”‚
â”‚     â””â”€> Pula prÃ©-carregamento (jÃ¡ tem cache)  [0 requests]                â”‚
â”‚                                                                             â”‚
â”‚  5. Frontend acessa /api/v1/matches                                         â”‚
â”‚     â””â”€> Cache HIT! Retorna instantÃ¢neo  [0 requests]                      â”‚
â”‚                                                                             â”‚
â”‚  âœ… RESULTADO:                                                              â”‚
â”‚  â€¢ Primeira carga do usuÃ¡rio: instantÃ¢nea                                   â”‚
â”‚  â€¢ 3 requests usados no startup (ao invÃ©s de 3 por usuÃ¡rio)               â”‚
â”‚  â€¢ Cache vÃ¡lido o dia todo                                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Impacto em Requests:**

| CenÃ¡rio | Antes (sem prÃ©-carga) | Depois (com prÃ©-carga) | Economia |
|---------|----------------------|------------------------|----------|
| **Startup** | 0 req | 3 req (1x) | -3 req |
| **UsuÃ¡rio 1 acessa** | 3 req (fixtures) | 0 req (cache) | +3 req |
| **UsuÃ¡rio 2 acessa** | 3 req (fixtures) | 0 req (cache) | +3 req |
| **UsuÃ¡rio 3 acessa** | 3 req (fixtures) | 0 req (cache) | +3 req |
| **Total (3 usuÃ¡rios)** | **9 req** | **3 req** | **âœ… 67% economia** |

**Custo:** 3 requests/dia (fixo no startup)  
**BenefÃ­cio:** N usuÃ¡rios Ã— 3 requests economizados  
**Break-even:** A partir de 2 usuÃ¡rios/dia jÃ¡ compensa

---

### **2. Webhooks (Futuro)**

Se API-Football oferecer webhooks:
- Receber notificaÃ§Ã£o quando odds mudam
- Atualizar cache automaticamente
- UsuÃ¡rios sempre tÃªm dados frescos

---

### **3. Monitoramento de Limite**

```python
# Antes de cada request crÃ­tico
status = await provider.get_status()

if status.remaining < 10:
    # Modo economia: sÃ³ usa cache
    # NÃ£o faz novos requests
    pass
```

---

## ğŸ¯ Estimativa de Capacidade

### **Com Cache Otimizado:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CAPACIDADE DIÃRIA (100 requests)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  CenÃ¡rio: UsuÃ¡rio acessa 3 ligas diferentes por dia        â”‚
â”‚  â€¢ BrasileirÃ£o: 1 + 10 = 11 requests                       â”‚
â”‚  â€¢ Copa do Brasil: 1 + 6 = 7 requests                      â”‚
â”‚  â€¢ Premier League: 1 + 8 = 9 requests                      â”‚
â”‚  Total por usuÃ¡rio: 27 requests/dia                        â”‚
â”‚                                                             â”‚
â”‚  Com cache ativo (recargas no mesmo dia): +10 requests     â”‚
â”‚  Total realista: 37 requests/dia por usuÃ¡rio               â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  USUÃRIOS SUPORTADOS: ~2-3 usuÃ¡rios/dia                    â”‚
â”‚  (Com uso pesado)                                           â”‚
â”‚                                                             â”‚
â”‚  USUÃRIOS SUPORTADOS: ~5-10 usuÃ¡rios/dia                   â”‚
â”‚  (Com cache eficiente - recargas)                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš¨ Alertas e Limites

### **Monitoramento de Requests**

```python
# web_api/src/infrastructure/external/api_football/api_football_client.py

class APIFootballClient:
    def __init__(self):
        self.request_count = 0
        self.daily_limit = 100
    
    async def get(self, endpoint: str):
        # Verifica limite
        if self.request_count >= self.daily_limit:
            raise APILimitExceededError("Limite diÃ¡rio atingido!")
        
        # Faz request
        response = await self._make_request(endpoint)
        
        # Incrementa contador
        self.request_count += 1
        
        # Log
        logger.info(f"Request #{self.request_count}/100 - {endpoint}")
        
        return response
```

---

## ğŸ“š Endpoints Utilizados

### **Core (CrÃ­ticos):**
| Endpoint | Uso | Cache TTL | Requests/Dia |
|----------|-----|-----------|--------------|
| `GET /fixtures` | Buscar jogos | 6 horas | 5-10 |
| `GET /odds` | Buscar cotaÃ§Ãµes | 30 minutos | 30-50 |
| `GET /status` | Monitorar limite | Sem cache | 3-5 |

### **Auxiliares (Ocasionais):**
| Endpoint | Uso | Cache TTL | Requests/Dia |
|----------|-----|-----------|--------------|
| `GET /leagues` | Listar ligas | 7 dias | 1 |
| `GET /teams` | Buscar times | 7 dias | 1-3 |
| `GET /bookmakers` | Listar casas | 7 dias | 1 |

---

## âœ… Checklist de ImplementaÃ§Ã£o

- [ ] Implementar CacheManager com SQLite
- [ ] Configurar TTLs por tipo de dado
- [ ] Implementar ProviderFactory
- [ ] Criar APIFootballClient com contador de requests
- [ ] Implementar Parsers (fixture, odds)
- [ ] Implementar Mappers (API â†’ Domain)
- [ ] Adicionar logs de requests
- [ ] Criar alerta de limite (90% = aviso)
- [ ] Implementar fallback de logos
- [ ] Testar cache hit/miss
- [ ] Monitorar requests no dashboard

---

## ğŸ”— ReferÃªncias

- ğŸ“š **DocumentaÃ§Ã£o API-Football:** https://www.api-football.com/documentation-v3
- ğŸ  **Dashboard:** https://dashboard.api-football.com/
- ğŸ“Š **Status da API:** `GET /status`
- ğŸ’¬ **Suporte:** https://www.api-football.com/support

---

**IntegraÃ§Ã£o otimizada e pronta para produÃ§Ã£o! ğŸš€**

